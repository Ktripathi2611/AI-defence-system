{% extends "base.html" %}

{% block title %}Scan - AI Defense System{% endblock %}
{% block header_title %}File Scanner{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/scan.css') }}">
{% endblock %}

{% block content %}
<div class="scan-container">
    <!-- Scan Types Sidebar -->
    <aside class="scan-sidebar">
        <div class="scan-type-card active" data-scan-type="malware">
            <div class="scan-type-icon">
                <i class="fas fa-virus-slash"></i>
            </div>
            <div class="scan-type-info">
                <h3>Malware Analysis</h3>
                <p>Advanced AI-powered detection of viruses, trojans, and malicious code patterns.</p>
            </div>
        </div>

        <div class="scan-type-card" data-scan-type="deepfake">
            <div class="scan-type-icon">
                <i class="fas fa-camera"></i>
            </div>
            <div class="scan-type-info">
                <h3>Deepfake Detection</h3>
                <p>State-of-the-art AI analysis to identify manipulated media content.</p>
            </div>
        </div>

        <div class="scan-type-card" data-scan-type="threat">
            <div class="scan-type-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <div class="scan-type-info">
                <h3>Threat Analysis</h3>
                <p>Comprehensive security assessment for potential vulnerabilities and risks.</p>
            </div>
        </div>
    </aside>

    <!-- Main Scan Area -->
    <main class="scan-main">
        <!-- Upload Area -->
        <div class="upload-area" id="uploadArea">
            <div class="upload-content">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Drop Files to Scan</h3>
                <p>Supports images, videos, and documents up to 50MB</p>
                <div class="upload-actions">
                    <input type="file" id="fileInput" multiple hidden>
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-plus"></i>
                        Select Files
                    </button>
                </div>
            </div>
        </div>

        <!-- File List -->
        <div class="file-list" id="fileList" style="display: none;">
            <div class="file-list-header">
                <h3>Files to Scan</h3>
                <div class="file-actions">
                    <button class="btn btn-secondary" onclick="clearFiles()">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                    <button class="btn btn-primary" onclick="startScan()">
                        <i class="fas fa-play"></i>
                        Start Scan
                    </button>
                </div>
            </div>
            <div class="file-items" id="fileItems">
                <!-- File items will be added here dynamically -->
            </div>
        </div>

        <!-- Scan Progress -->
        <div class="scan-progress" id="scanProgress" style="display: none;">
            <div class="progress-header">
                <h3>Scan in Progress</h3>
                <div class="progress-status">
                    <div class="progress-info">
                        <span id="progressText">0%</span>
                        <span class="progress-time" id="progressTime">Estimated time: calculating...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>
            <div class="current-file">
                <span>Currently Scanning:</span>
                <span id="currentFile" class="filename">No file selected</span>
            </div>
        </div>

        <!-- Scan Results -->
        <div class="scan-results" id="scanResults" style="display: none;">
            <div class="results-header">
                <h3>Scan Results</h3>
                <div class="results-actions">
                    <button class="btn btn-secondary" onclick="exportResults()">
                        <i class="fas fa-download"></i>
                        Export Report
                    </button>
                    <button class="btn btn-primary" onclick="newScan()">
                        <i class="fas fa-redo"></i>
                        New Scan
                    </button>
                </div>
            </div>
            <div class="results-grid" id="resultsGrid">
                <!-- Results will be added here dynamically -->
            </div>
        </div>
    </main>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/scan.js') }}"></script>
{% endblock %}
